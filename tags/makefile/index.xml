<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Makefile on Daemon365</title><link>https://daemon365.dev/tags/makefile/</link><description>Don't let yourself stop.</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 15 Dec 2021 00:00:00 +0800</lastBuildDate><atom:link href="https://daemon365.dev/tags/makefile/index.xml" rel="self" type="application/rss+xml"/><item><title>makefile</title><link>https://daemon365.dev/post/cloud/makefile/</link><pubDate>Wed, 15 Dec 2021 00:00:00 +0800</pubDate><guid>https://daemon365.dev/post/cloud/makefile/</guid><description>&lt;h2 id="make"&gt;make&lt;/h2&gt;
&lt;p&gt;make是一个构建自动化工具，会在当前目录下寻找Makefile或makefile文件。如果存在相应的文件，它就会依据其中定义好的规则完成构建任务。&lt;/p&gt;
&lt;h2 id="makefile"&gt;makefile&lt;/h2&gt;
&lt;p&gt;什么是makefile？或许很多Winodws的程序员都不知道这个东西，因为那些Windows的IDE都为你做了这个工作，但我觉得要作一个好的和professional的程序员，makefile还是要懂。这就好像现在有这么多的HTML的编辑器，但如果你想成为一个专业人士，你还是要了解HTML的标识的含义。特别在Unix下的软件编译，你就不能不自己写makefile了，&lt;strong&gt;会不会写makefile，从一个侧面说明了一个人是否具备完成大型工程的能力&lt;/strong&gt;。因为，makefile关系到了整个工程的编译规则。一个工程中的源文件不计数，其按&lt;strong&gt;&lt;strong&gt;类型、功能、模块&lt;/strong&gt;&lt;/strong&gt;分别放在若干个目录中，makefile定义了一系列的规则来指定，哪些文件需要先编译，哪些文件需要后编译，哪些文件需要重新编译，甚至于进行更复杂的功能操作，因为makefile就像一个Shell脚本一样，其中也可以执行操作系统的命令。makefile带来的好处就是——“自动化编译”，一旦写好，只需要一个make命令，整个工程完全自动编译，极大的提高了软件开发的效率。make是一个命令工具，是一个解释makefile中指令的命令工具，一般来说，大多数的IDE都有这个命令，比如：Delphi的make，Visual C++的nmake，Linux下GNU的make。可见，makefile都成为了一种在工程方面的编译方法。&lt;/p&gt;
&lt;h2 id="规则概述"&gt;规则概述&lt;/h2&gt;
&lt;p&gt;Makefile由多条规则组成，每条规则主要由两个部分组成，分别是依赖的关系和执行的命令。&lt;/p&gt;
&lt;p&gt;其结构如下所示：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[target] ... : [prerequisites] ...
[command]
...
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;targets：规则的目标&lt;/li&gt;
&lt;li&gt;prerequisites：可选的要生成 targets 需要的文件或者是目标。&lt;/li&gt;
&lt;li&gt;command：make 需要执行的命令（任意的 shell 命令）。可以有多条命令，每一条命令占一行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;举个例子：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;build&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ae81ff"&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o xx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="示例"&gt;示例&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;.PHONY&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;all build run gotool clean help&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;BINARY=&amp;#34;coursemanager&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;all&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;build&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;build&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ae81ff"&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o ${BINARY}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;run&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;go run ./&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;gotool&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ae81ff"&gt;go fmt ./&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ae81ff"&gt;go vet ./&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;clean&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;if [ -f ${BINARY} ] ; then rm ${BINARY} ; fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;help&lt;/span&gt;&lt;span style="color:#111"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;echo &amp;#34;make - 格式化 Go 代码, 并编译生成二进制文件&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;echo &amp;#34;make build - 编译 Go 代码, 生成二进制文件&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;echo &amp;#34;make run - 直接运行 Go 代码&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;echo &amp;#34;make clean - 移除二进制文件和 vim swap files&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; @&lt;span style="color:#ae81ff"&gt;echo &amp;#34;make gotool - 运行 Go 工具 &amp;#39;fmt&amp;#39; and &amp;#39;vet&amp;#39;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;参考文章:&lt;/p&gt;</description><content:encoded><![CDATA[<h2 id="make">make</h2>
<p>make是一个构建自动化工具，会在当前目录下寻找Makefile或makefile文件。如果存在相应的文件，它就会依据其中定义好的规则完成构建任务。</p>
<h2 id="makefile">makefile</h2>
<p>什么是makefile？或许很多Winodws的程序员都不知道这个东西，因为那些Windows的IDE都为你做了这个工作，但我觉得要作一个好的和professional的程序员，makefile还是要懂。这就好像现在有这么多的HTML的编辑器，但如果你想成为一个专业人士，你还是要了解HTML的标识的含义。特别在Unix下的软件编译，你就不能不自己写makefile了，<strong>会不会写makefile，从一个侧面说明了一个人是否具备完成大型工程的能力</strong>。因为，makefile关系到了整个工程的编译规则。一个工程中的源文件不计数，其按<strong><strong>类型、功能、模块</strong></strong>分别放在若干个目录中，makefile定义了一系列的规则来指定，哪些文件需要先编译，哪些文件需要后编译，哪些文件需要重新编译，甚至于进行更复杂的功能操作，因为makefile就像一个Shell脚本一样，其中也可以执行操作系统的命令。makefile带来的好处就是——“自动化编译”，一旦写好，只需要一个make命令，整个工程完全自动编译，极大的提高了软件开发的效率。make是一个命令工具，是一个解释makefile中指令的命令工具，一般来说，大多数的IDE都有这个命令，比如：Delphi的make，Visual C++的nmake，Linux下GNU的make。可见，makefile都成为了一种在工程方面的编译方法。</p>
<h2 id="规则概述">规则概述</h2>
<p>Makefile由多条规则组成，每条规则主要由两个部分组成，分别是依赖的关系和执行的命令。</p>
<p>其结构如下所示：</p>
<pre tabindex="0"><code>[target] ... : [prerequisites] ...
[command]
    ...
    ...
</code></pre><p>其中：</p>
<ul>
<li>targets：规则的目标</li>
<li>prerequisites：可选的要生成 targets 需要的文件或者是目标。</li>
<li>command：make 需要执行的命令（任意的 shell 命令）。可以有多条命令，每一条命令占一行。</li>
</ul>
<p>举个例子：</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">build</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o xx</span>
</span></span></code></pre></div><h2 id="示例">示例</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">.PHONY</span><span style="color:#111">:</span> <span style="color:#ae81ff">all build run gotool clean help</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">BINARY=&#34;coursemanager&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">all</span><span style="color:#111">:</span> <span style="color:#ae81ff">build</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">build</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o ${BINARY}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">run</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">go run ./</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">gotool</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">go fmt ./</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">go vet ./</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">clean</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">if [ -f ${BINARY} ] ; then rm ${BINARY} ; fi</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">help</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">echo &#34;make - 格式化 Go 代码, 并编译生成二进制文件&#34;</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">echo &#34;make build - 编译 Go 代码, 生成二进制文件&#34;</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">echo &#34;make run - 直接运行 Go 代码&#34;</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">echo &#34;make clean - 移除二进制文件和 vim swap files&#34;</span>
</span></span><span style="display:flex;"><span>	@<span style="color:#ae81ff">echo &#34;make gotool - 运行 Go 工具 &#39;fmt&#39; and &#39;vet&#39;&#34;</span>
</span></span></code></pre></div><p>参考文章:</p>
<ul>
<li><a href="https://www.liwenzhou.com/posts/Go/makefile/">https://www.liwenzhou.com/posts/Go/makefile/</a></li>
<li><a href="https://blog.csdn.net/weixin_38391755/article/details/80380786">https://blog.csdn.net/weixin_38391755/article/details/80380786</a></li>
</ul>
]]></content:encoded><category>cloud</category><category>makefile</category></item></channel></rss>