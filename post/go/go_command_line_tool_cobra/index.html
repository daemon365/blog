<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Go命令行工具cobra - Daemon365</title><link rel=icon href=/imgs/favicon.ico><link rel=manifest href=/manifest.json><meta name=theme-color content="#007aff"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><meta name=apple-mobile-web-app-title content="Daemon365"><meta name=description content="关于
Cobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。
Cobra 由 Go 项目成员和 hugo 作者 spf13 创建，已经被许多流行的 Go 项目采用，比如 …"><meta name=keywords content="go"><meta name=author content="daemon365"><meta property="og:type" content="article"><meta property="og:url" content="https://daemon365.dev/post/go/go_command_line_tool_cobra/"><meta property="og:title" content="Go命令行工具cobra - Daemon365"><meta property="og:description" content="关于
Cobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。
Cobra 由 Go 项目成员和 hugo 作者 spf13 创建，已经被许多流行的 Go 项目采用，比如 …"><meta property="og:image" content="https://daemon365.dev/imgs/avatar.svg"><meta property="og:locale" content="en"><meta property="og:site_name" content="Daemon365"><meta property="article:published_time" content="2022-12-21T00:00:00+08:00"><meta property="article:modified_time" content="2022-12-21T00:00:00+08:00"><meta property="article:author" content="daemon365"><meta property="article:section" content="go"><meta property="article:tag" content="go"><meta name=twitter:card content="summary_large_image"><meta name=twitter:url content="https://daemon365.dev/post/go/go_command_line_tool_cobra/"><meta name=twitter:title content="Go命令行工具cobra - Daemon365"><meta name=twitter:description content="关于
Cobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。
Cobra 由 Go 项目成员和 hugo 作者 spf13 创建，已经被许多流行的 Go 项目采用，比如 …"><meta name=twitter:image content="https://daemon365.dev/imgs/avatar.svg"><link rel=canonical href=https://daemon365.dev/post/go/go_command_line_tool_cobra/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Go命令行工具cobra","description":"\u003ch2 id=\u0022关于\u0022\u003e关于\u003c\/h2\u003e\n\u003cp\u003eCobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。\u003c\/p\u003e\n\u003cp\u003eCobra 由 Go 项目成员和 hugo 作者 \u003ca href=\u0022https:\/\/github.com\/spf13\u0022\u003espf13\u003c\/a\u003e 创建，已经被许多流行的 Go 项目采用，比如 …\u003c\/p\u003e","datePublished":"2022-12-21T00:00:00\u002b08:00","dateModified":"2022-12-21T00:00:00\u002b08:00","author":{"@type":"Person","name":"daemon365"},"publisher":{"@type":"Organization","name":"Daemon365","logo":{"@type":"ImageObject","url":"https:\/\/daemon365.dev\/imgs\/favicon.ico"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/daemon365.dev\/post\/go\/go_command_line_tool_cobra\/"},"inLanguage":"en"}</script><meta name=robots content="index, follow"><meta name=googlebot content="index, follow"><link rel=stylesheet href=/css/components/variables.css><link rel=stylesheet href=/css/components/base.css><link rel=stylesheet href=/css/components/layout.css><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/components/search.css><link rel=stylesheet href=/css/components/toc.css><link rel=stylesheet href=/css/components/image-preview.css><link rel=stylesheet href=/css/components/reading-progress.css><style>:root{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif}</style></head><body><div class=reading-progress-bar></div><header class=site-header><div class=container><div class=header-content><div class=site-branding><a href=/ class=site-logo><span class=site-title>Daemon365</span></a></div><nav class=site-nav><ul class=nav-menu><li><a href=/><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
Home</a></li><li><a href=/about><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
About</a></li><li><a href=/archives><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
Archives</a></li><li><a href=/categories><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
Categories</a></li><li><a href=/tags><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
Tags</a></li><li><button class=search-trigger aria-label=Search>
<svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
Search</button></li></ul></nav></div></div></header><main class=main-content><div class=post-container><div class=container><article class=post-content><header class=post-header><h1 class=post-title>Go命令行工具cobra</h1><div class=post-meta><time datetime=2022-12-21><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2022-12-21
</time><a href=/categories/go class=category-link><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
go
</a><span class=reading-time><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
2 min read
</span><span class=word-count><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
405 words</span></div><div class=post-tags><a href=/tags/go class=tag><svg class="icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
go</a></div></header><div class=post-body><h2 id=关于>关于</h2><p>Cobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。</p><p>Cobra 由 Go 项目成员和 hugo 作者 <a href=https://github.com/spf13>spf13</a> 创建，已经被许多流行的 Go 项目采用，比如 kubernetes、docker等</p><h2 id=特性>特性</h2><ul><li>简单的基于子命令的 CLIs：<code>app server</code>、<code>app fetch</code> 等；</li><li>完全兼容 <a href=https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3>POSIX（可移植操作系统接口）</a> 的标志（包括短版和长版）</li><li>嵌套子命令</li><li>全局、局部和级联的标志</li><li>使用 <code>cobra init appname</code> 和 <code>cobra add cmdname</code> 轻松生成应用程序和命令</li><li>智能提示（<code>app srver</code> &mldr;did you mean <code>app server</code>）</li><li>自动生成命令和标志的帮助</li><li>自动识别 <code>-h</code>、<code>--help</code> 等帮助标识</li><li>自动为你的应用程序生成的 bash 自动完成</li><li>自动为你的应用程序生成 man 手册</li><li>命令别名，以便你可以更改内容而不会破坏它们</li><li>定义自己的帮助，用法等的灵活性。</li><li>可选与 <a href=https://github.com/spf13/viper>viper</a> 紧密集成，可用于 <a href=https://12factor.net/zh_cn/>12factor</a> 应用程序</li></ul><h2 id=概念>概念</h2><p>Cobra 构建在命令（commands）、参数（arguments）和 标志（flags）上。</p><p><strong>Commands</strong> 代表动作，<strong>Args</strong> 是事物，<strong>Flags</strong> 是这些动作的修饰符。</p><p>最好的应用程序在使用时会像句子一样读起来。用户将知道如何使用该应用程序，因为他们将自然地了解如何使用它。</p><p>遵循的模式是 <code>APPNAME VERB NOUN --ADJECTIVE</code>。 或 <code>APPNAME COMMAND ARG --FLAG</code></p><p>一些真实的例子可以更好地说明这一点。</p><p>在以下示例中，<code>server</code> 是命令，<code>port</code> 是标志：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>hugo server --port<span style=color:#f92672>=</span><span style=color:#ae81ff>1313</span>
</span></span></code></pre></div><p>在此命令中，我们告诉 Git 克隆 url 的内容：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone URL --bare
</span></span></code></pre></div><h3 id=命令command>命令（Command）</h3><p>命令是应用程序的核心。应用程序提供的每一个交互都包含在 Command 中。一个命令可以有子命令和可选的运行一个动作。</p><p>在上面的示例中，<code>server</code> 是命令。</p><p><a href=https://pkg.go.dev/github.com/spf13/cobra#Command>Cobra.Command API</a>)</p><h3 id=标志flags>标志（Flags）</h3><p>一个标志是一种修饰命令行为的方式。Cobra 支持完全符合 [<a href=https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3>https://zh.wikipedia.org/wiki/可移植操作系统接口</a>) 包。</p><p>Cobra 命令可以定义一直保留到子命令的标志和仅可用于该命令的标志。</p><p>在上面的例子中，<code>port</code> 是标志。</p><p>标志的功能是 <a href=https://github.com/spf13/pflag>pflag</a> 库提供的，该库是一个标准库的 fork，在维护相同接口的基础上兼容了 <a href=https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3>POSIX（可移植操作系统接口）</a>。</p><h2 id=简单使用>简单使用</h2><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 目录结构</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>├──</span> <span style=color:#75af00>add</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span>   <span style=color:#960050;background-color:#1e0010>└──</span> <span style=color:#75af00>add</span><span style=color:#111>.</span><span style=color:#00a8c8>go</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>├──</span> <span style=color:#00a8c8>go</span><span style=color:#111>.</span><span style=color:#75af00>mod</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>├──</span> <span style=color:#00a8c8>go</span><span style=color:#111>.</span><span style=color:#75af00>sum</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>└──</span> <span style=color:#75af00>main</span><span style=color:#111>.</span><span style=color:#00a8c8>go</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// main.go</span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#75af00>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>(</span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#34;log&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#34;test/add&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#34;github.com/spf13/cobra&#34;</span>
</span></span><span style=display:flex><span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>rootCmd</span> <span style=color:#111>=</span> <span style=color:#f92672>&amp;</span><span style=color:#75af00>cobra</span><span style=color:#111>.</span><span style=color:#75af00>Command</span><span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Use</span><span style=color:#111>:</span>     <span style=color:#d88200>&#34;test&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Short</span><span style=color:#111>:</span>   <span style=color:#d88200>&#34;测试&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Long</span><span style=color:#111>:</span>    <span style=color:#d88200>`我要写博客做个测试呢,这是个常提示`</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Version</span><span style=color:#111>:</span> <span style=color:#d88200>&#34;v1.1&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>func</span> <span style=color:#75af00>init</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>rootCmd</span><span style=color:#111>.</span><span style=color:#75af00>AddCommand</span><span style=color:#111>(</span><span style=color:#75af00>add</span><span style=color:#111>.</span><span style=color:#75af00>CmdAdd</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>func</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#00a8c8>if</span> <span style=color:#75af00>err</span> <span style=color:#f92672>:=</span> <span style=color:#75af00>rootCmd</span><span style=color:#111>.</span><span style=color:#75af00>Execute</span><span style=color:#111>();</span> <span style=color:#75af00>err</span> <span style=color:#f92672>!=</span> <span style=color:#00a8c8>nil</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>		<span style=color:#75af00>log</span><span style=color:#111>.</span><span style=color:#75af00>Fatal</span><span style=color:#111>(</span><span style=color:#75af00>err</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>	<span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// add/add.go</span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#75af00>add</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>(</span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#34;github.com/spf13/cobra&#34;</span>
</span></span><span style=display:flex><span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>CmdAdd</span> <span style=color:#111>=</span> <span style=color:#f92672>&amp;</span><span style=color:#75af00>cobra</span><span style=color:#111>.</span><span style=color:#75af00>Command</span><span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Use</span><span style=color:#111>:</span>   <span style=color:#d88200>&#34;add&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Short</span><span style=color:#111>:</span> <span style=color:#d88200>&#34;新键&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>Long</span><span style=color:#111>:</span>  <span style=color:#d88200>&#34;新建个文件&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>RunE</span><span style=color:#111>:</span>  <span style=color:#75af00>RunE</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>path</span> <span style=color:#00a8c8>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>func</span> <span style=color:#75af00>init</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>CmdAdd</span><span style=color:#111>.</span><span style=color:#75af00>Flags</span><span style=color:#111>().</span><span style=color:#75af00>StringVarP</span><span style=color:#111>(</span><span style=color:#f92672>&amp;</span><span style=color:#75af00>path</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;path&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;p&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>path</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;file path&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>func</span> <span style=color:#75af00>RunE</span><span style=color:#111>(</span><span style=color:#75af00>cmd</span> <span style=color:#f92672>*</span><span style=color:#75af00>cobra</span><span style=color:#111>.</span><span style=color:#75af00>Command</span><span style=color:#111>,</span> <span style=color:#75af00>args</span> <span style=color:#111>[]</span><span style=color:#00a8c8>string</span><span style=color:#111>)</span> <span style=color:#00a8c8>error</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75af00>fmt</span><span style=color:#111>.</span><span style=color:#75af00>Println</span><span style=color:#111>(</span><span style=color:#d88200>&#34;假装创建个文件 path=&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>path</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>	<span style=color:#00a8c8>return</span> <span style=color:#00a8c8>nil</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></div><p>执行结果</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># go run main.go --help</span>
</span></span><span style=display:flex><span>我要写博客做个测试呢,这是个常提示
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Usage:
</span></span><span style=display:flex><span>  <span style=color:#111>test</span> <span style=color:#f92672>[</span>command<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Available Commands:
</span></span><span style=display:flex><span>  add         新键
</span></span><span style=display:flex><span>  completion  Generate the autocompletion script <span style=color:#00a8c8>for</span> the specified shell
</span></span><span style=display:flex><span>  <span style=color:#111>help</span>        Help about any <span style=color:#111>command</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Flags:
</span></span><span style=display:flex><span>  -h, --help      <span style=color:#111>help</span> <span style=color:#00a8c8>for</span> <span style=color:#111>test</span>
</span></span><span style=display:flex><span>  -v, --version   version <span style=color:#00a8c8>for</span> <span style=color:#111>test</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Use <span style=color:#d88200>&#34;test [command] --help&#34;</span> <span style=color:#00a8c8>for</span> more information about a command.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># go run main.go add --help</span>
</span></span><span style=display:flex><span>新建个文件
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Usage:
</span></span><span style=display:flex><span>  <span style=color:#111>test</span> add <span style=color:#f92672>[</span>flags<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Flags:
</span></span><span style=display:flex><span>  -h, --help          <span style=color:#111>help</span> <span style=color:#00a8c8>for</span> add
</span></span><span style=display:flex><span>  -p, --path string   file path
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># go run main.go add --path=/user/pass </span>
</span></span><span style=display:flex><span>假装创建个文件 <span style=color:#111>path</span><span style=color:#f92672>=</span> /user/pass
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># go run main.go --version</span>
</span></span><span style=display:flex><span><span style=color:#111>test</span> version v1.1
</span></span></code></pre></div><h2 id=command参数>Command参数</h2><p>例子中的<code>cobra.Command</code>是个结构体，有很多字段，都是做什么用的呢？</p><p>这些参数是Go语言中<code>cobra</code>库中的<code>Command</code>结构体的字段，用于定义命令行工具的行为和选项。它们的作用如下：</p><ul><li><code>Use</code>: 命令名称。</li><li><code>Aliases</code>: 命令的别名。</li><li><code>SuggestFor</code>: 命令建议使用的单词列表。</li><li><code>Short</code>: 命令简短描述。</li><li><code>GroupID</code>: 命令所属的命令组。</li><li><code>Long</code>: 命令详细描述。</li><li><code>Example</code>: 命令的使用示例。</li><li><code>ValidArgs</code>: 命令接受的参数列表。</li><li><code>ValidArgsFunction</code>: 命令用于提供动态参数补全的函数。</li><li><code>Args</code>: 命令的位置参数列表。</li><li><code>ArgAliases</code>: 位置参数的别名。</li><li><code>BashCompletionFunction</code>: 生成Bash补全的函数。</li><li><code>Deprecated</code>: 命令是否已经过时的标志。</li><li><code>Annotations</code>: 命令的附加注释信息。</li><li><code>Version</code>: 命令版本号。</li><li><code>PersistentPreRun</code>: 每次执行该命令之前都会执行的函数。</li><li><code>PersistentPreRunE</code>: 每次执行该命令之前都会执行的返回错误的函数。</li><li><code>PreRun</code>: 每次执行该命令之前都会执行的函数。</li><li><code>PreRunE</code>: 每次执行该命令之前都会执行的返回错误的函数。</li><li><code>Run</code>: 执行命令的函数。</li><li><code>RunE</code>: 执行命令的返回错误的函数。</li><li><code>PostRun</code>: 每次执行该命令之后都会执行的函数。</li><li><code>PostRunE</code>: 每次执行该命令之后都会执行的返回错误的函数。</li><li><code>PersistentPostRun</code>: 每次执行该命令之后都会执行的函数。</li><li><code>PersistentPostRunE</code>: 每次执行该命令之后都会执行的返回错误的函数。</li><li><code>FParseErrWhitelist</code> : 忽略特定的解析错误</li><li><code>CompletionOptions</code> :控制 shell 自动完成的选项</li><li><code>TraverseChildren</code>: 解析父命令的标志后再执行子命令</li><li><code>Hidden</code> : 隐藏命令，不在可用命令列表中显示</li><li><code>SilenceErrors</code> : 静默下游错误</li><li><code>SilenceUsage</code> : 静默错误时不显示用法</li><li><code>DisableFlagParsing</code> : 禁用标志解析</li><li><code>DisableAutoGenTag</code> : 禁用自动生成的标记</li><li><code>DisableFlagsInUseLine</code> : 在打印帮助或生成文档时禁用“[flags]”在用法行中的添加</li><li><code>DisableSuggestions</code> : 禁用基于Levenshtein距离的建议</li><li><code>SuggestionsMinimumDistance</code> : 显示建议的最小Levenshtein距离</li></ul><h2 id=reference>Reference</h2><ul><li><a href=https://juejin.cn/post/6924541628031959047>https://juejin.cn/post/6924541628031959047</a></li><li><a href=https://cobra.dev/>Cobra. Dev</a></li></ul></div><footer class=post-footer><div class=post-license><p><strong>Article Title:</strong> Go命令行工具cobra</p><p><strong>Author:</strong> daemon365</p><p><strong>Permalink:</strong> <a href=https://daemon365.dev/post/go/go_command_line_tool_cobra/>https://daemon365.dev/post/go/go_command_line_tool_cobra/</a></p><p><strong>License:</strong> This article is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>BY-NC-SA</a>. Please cite the source when reposting.</p></div><nav class=post-navigation><a href=/post/others/lua_basics/ class=nav-prev><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg><div><span class=nav-label>Previous</span>
<span class=nav-title>lua基础</span></div></a><a href=/post/microservice/timeout_control/ class=nav-next><div><span class=nav-label>Next</span>
<span class=nav-title>超时控制</span></div><svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></a></nav><div class=post-comments><script src=https://utteranc.es/client.js repo=daemon365/blog issue-term=pathname label=comments theme=preferred-color-scheme crossorigin=anonymous async></script></div></footer></article></div></div><div class=toc-float-button id=tocButton><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5.0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5.0 014 19.5v-15A2.5 2.5.0 016.5 2z"/></svg></div><div class=toc-panel id=tocPanel><div class=toc-panel-header><h3 class=toc-panel-title>Table of Contents</h3><button class=toc-panel-close id=tocClose>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><nav class=toc-panel-nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#关于>关于</a></li><li><a href=#特性>特性</a></li><li><a href=#概念>概念</a><ul><li><a href=#命令command>命令（Command）</a></li><li><a href=#标志flags>标志（Flags）</a></li></ul></li><li><a href=#简单使用>简单使用</a></li><li><a href=#command参数>Command参数</a></li><li><a href=#reference>Reference</a></li></ul></nav></nav></div></main><footer class=site-footer><div class=container><div class=footer-content><div class=footer-info><p class=copyright>© 2025 daemon365</p><p class=powered-by>Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/daemon365/hugo-theme-daemon target=_blank rel=noopener>Daemon</a></p></div><div class=social-links><a href=https://github.com/daemon365 target=_blank rel=noopener aria-label=GitHub><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.374.0.0 5.373.0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931.0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176.0.0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221.0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg>
</a><a href=mailto:daemon365@foxmail.com aria-label=Email><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></div></div></footer><div class=search-modal id=searchModal><div class=search-modal-backdrop></div><div class=search-modal-content><div class=search-modal-header><input type=text class=search-input id=searchInput placeholder="Search articles..." autofocus>
<button class=search-close aria-label="Close search">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class=search-results id=searchResults><p class=search-hint>Enter 2 or more characters to start searching</p></div></div></div><script src=/js/components/search.js></script><script src=/js/components/toc.js></script><script src=/js/components/scroll-effects.js></script><script src=/js/components/code-copy.js></script><script src=/js/components/lazy-loading.js></script><script src=/js/components/image-preview.js></script><script src=/js/components/back-to-top.js></script><script src=/js/main-new.js></script><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered:",e.scope)}).catch(e=>{console.log("Service Worker registration failed:",e)})})</script></body></html>